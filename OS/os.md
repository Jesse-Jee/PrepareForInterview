#分页分段内存管理


#  进程五种状态及状态间转移


## 进程
进程是操作系统资源分配的基本单位。
一个程序在系统上运行时，就是一个进程。
每个进程都有自己的虚拟地址空间，虚拟地址空间划分为内核空间和用户空间。操作系统运行在内核空间，内核空间由所有进程的地址空间共享。
用户程序不能直接访问内核空间，操作系统保存的进程控制信息在内核空间中。  
进程控制信息中包含：  
- 页目录  
- 父进程ID
- 状态
- 句柄表
- 等等

## 线程  
线程是进程中的执行体，它会有指定的执行入口，通常是某个函数的指令入口。线程执行时要使用从进程虚拟空间中分配的栈空间来存储数据。
被称为线程栈。


###   什么是虚拟内存
DOS时期，进程使用内存是直接使用物理地址，因为进程会修改地址上的信息，不同进程可能造成内存修改冲突。
甚至可能会覆盖操作系统使用的内存，后来，出现了保护模式，内存使用虚拟内存而非物理内存。操作系统负责把虚拟内存映射到物理内存上。

如何映射？
保护模式提供物理内存分页，把物理内存中的每4KB作为一页。从虚拟内存到物理内存以页为单位映射。
操作系统会以链表的形式记录各个进程的控制信息，在window中叫内存控制块，Linux中叫task_struct。每个进程的控制信息中都有一个这样的指针，
记录当前进程"页目录"的物理地址。页目录也是一个内存页，存储的是一系列指针，指向同样用来存储物理内存页起始地址的"页表"。

在32位CPU下，一个地址占4个字节，一个页目录就可以寻址1024个页表，而每个页表又可以寻址1024个物理内存页，每个页4K。
因此， 1024 * 1024 * 4K = 4GB

线性地址：
前10位从页目录中选择一个页表。
中10位从页表中锁定一个物理内存页。
后12位存储一个相对内存页起始地址的偏移量。
这样就实现了一个虚拟内存到一个物理内存的映射。

这样就可以让不同进程使用不同的物理地址，也可以让两个进程使用同一块物理地址实现共享内存。


页表中的记录：
内存页大小都是4KB，所以内存页的地址一定是4K的整数倍，也就是说，它的低12位一定是0。因此页表中的每一条记录都有一个12位的空闲空间可以使用。
它们可以用来标识对应物理内存页是否可读可写可执行等信息，其中一位用于标识物理内存页是否已经映射。

###  进程向操作系统申请映射的内存   
通常不会一申请就立马分配。
进程拿到的是线性地址，CPU拿到的自然也是线性地址，线性地址的转换会交由CPU中MMU模块完成。当前进程持有的页目录的物理地址会被保存到特定计时器。
这样CPU就可以借助页目录和MMU将线性地址转换为物理地址了。

由于频繁查询页表会影响效率，因此CPU会把已经映射过地址缓存到TLB（translation lookaside buffer），需要映射地址时会先从TLB中查找，
没有的话再去查页表，然后写入TLB。
如果对应物理内存页还没映射，就会发生 page fault。





## 进程状态
五种状态：新建，就绪，运行，阻塞，死亡。



#进程间通信


#select/poll/epoll 原理及底层实现


#io多路复用


#硬链接和软链接



#虚拟内存



#内存分页


#死锁


#并发、并行

#ping命令的底层原理

#共享内存


#内核态和用户态


#孤儿进程


#扫描二维码原理

#Linux命令 给文件改名 查文件 查文件内容 查暴露端口

#Linux grep命令


